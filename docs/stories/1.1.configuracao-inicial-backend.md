# Story 1.1: Configuração Inicial do Backend

## Status
**Rascunho**

## Story
**Como um** desenvolvedor,
**Eu quero** configurar a estrutura inicial do projeto de backend seguindo a Arquitetura Hexagonal,
**Para que** tenhamos uma base de código organizada, padronizada e pronta para desenvolvimento das funcionalidades principais do sistema de controle financeiro.

## Contexto do Épico
**Épico:** Fundação e Controle Financeiro Essencial

**Relacionamento:** Esta é a primeira história do épico fundacional, estabelecendo a base técnica necessária para todas as demais funcionalidades do sistema.

**Dependências:** Nenhuma - História inicial do projeto.

## Critérios de Aceitação

1. **Estrutura de projeto criada:**
   - Estrutura de pastas seguindo Arquitetura Hexagonal conforme documentação (`/core/`, `/adapters/`, `/config/`)
   - Separação clara entre domínio, portas, adaptadores e configurações

2. **Configuração do ambiente Python:**
   - Projeto configurado com UV como gerenciador de dependências
   - Arquivo `pyproject.toml` configurado com metadados do projeto
   - Ambiente virtual Python 3.12+ configurado

3. **Dependências principais instaladas:**
   - FastAPI (~0.111.x) como framework web
   - Uvicorn (~0.29.x) como servidor ASGI
   - Motor (~3.4.x) como driver MongoDB assíncrono
   - Pydantic (~2.7.x) para validação de dados
   - Python-jose para JWT
   - Pytest (~8.2.x) para testes
   - **IMPORTANTE**: Todas as dependências instaladas exclusivamente no `.venv` (ambiente isolado)

4. **Configuração de ambiente:**
   - Arquivo `.env.example` criado com variáveis de ambiente padrão
   - Configurações centralizadas em `app/config/settings.py`
   - Suporte para diferentes ambientes (dev, prod)
   - Ambiente virtual `.venv` configurado e isolado da máquina host

5. **Makefile robusto e profissional:**
   - Makefile com comandos para setup, desenvolvimento, testes e deploy
   - Comandos para gerenciamento do ambiente virtual
   - Automação de tarefas comuns (install, test, run, clean, lint)
   - Validação de pré-requisitos e dependências
   - Comandos para diferentes ambientes (dev, prod, test)

6. **Health check endpoint:**
   - Endpoint `GET /health` retornando `{"status": "OK"}` com código HTTP 200
   - Aplicação FastAPI executando sem erros
   - Servidor rodando na porta 8000

7. **Documentação inicial:**
   - README.md com instruções de setup e execução
   - Documentação automática do FastAPI acessível em `/docs`

## Definição de Pronto

- [x] Código implementado e revisado
- [x] Testes unitários escritos e passando
- [x] Estrutura de projeto seguindo padrões arquiteturais
- [x] Documentação atualizada
- [x] Aplicação executando sem erros
- [x] Health check endpoint funcional
- [x] Configurações de ambiente definidas

## Notas Técnicas

**Abordagem Técnica:** Implementação seguindo estritamente o padrão de Arquitetura Hexagonal, com separação clara entre camadas e uso de inversão de dependência.

**Considerações de Arquitetura:** 
- Core/Domain isolado de tecnologias externas
- Ports definindo interfaces de comunicação
- Adapters implementando interfaces para tecnologias específicas
- Configurações centralizadas e injetáveis

**APIs/Integrações:** 
- FastAPI como adaptador de entrada (API REST)
- Motor como adaptador de saída (MongoDB)
- Preparação para futuras integrações

**Considerações de Performance:** 
- Configuração assíncrona do FastAPI e Motor
- Preparação para connection pooling do MongoDB

**Automação e Workflow:**
- Makefile profissional com comandos padronizados para desenvolvimento
- Isolamento completo do ambiente (.venv) para evitar conflitos com sistema host
- Automação de tarefas repetitivas (setup, instalação, execução, testes)
- Validação de pré-requisitos antes da execução de comandos

## Tarefas / Subtarefas

**Tarefas de Desenvolvimento:**
- [ ] Criar estrutura de pastas seguindo Arquitetura Hexagonal
- [ ] Configurar `pyproject.toml` com dependências e metadados
- [ ] Implementar configurações centralizadas em `settings.py`
- [ ] Criar arquivo `.env.example` com variáveis padrão
- [ ] Implementar health check endpoint em `/health`
- [ ] Configurar aplicação FastAPI principal em `main.py`
- [ ] Criar interfaces base para ports (database, auth)
- [ ] **Criar Makefile robusto com comandos essenciais:**
  - [ ] `make setup` - configuração inicial do ambiente (.venv e dependências)
  - [ ] `make install` - instalação de dependências no .venv
  - [ ] `make dev` - execução em modo desenvolvimento
  - [ ] `make test` - execução de testes
  - [ ] `make lint` - verificação de qualidade de código
  - [ ] `make clean` - limpeza de arquivos temporários e cache
  - [ ] `make help` - documentação dos comandos disponíveis
- [ ] **Garantir isolamento completo no .venv (nada instalado na máquina)**

**Tarefas de Teste:**
- [ ] Implementar teste unitário para health check endpoint
- [ ] Criar estrutura de testes seguindo organização do projeto
- [ ] Configurar pytest com configurações base

**Tarefas de Documentação:**
- [ ] Criar README.md com instruções de setup
- [ ] Documentar estrutura de pastas e sua finalidade
- [ ] Configurar documentação automática do FastAPI

## Estimativa

**Story Points:** 3

**Horas Estimadas:** 8-12 horas

**Complexidade:** Baixa - Configuração inicial padrão

**Riscos/Incertezas:** 
- Possíveis conflitos de versão entre dependências
- Configuração correta do ambiente assíncrono

## Estratégia de Testes

**Cenários de Teste:**
- Teste de inicialização da aplicação
- Teste do endpoint health check
- Teste de carregamento de configurações
- Teste dos comandos do Makefile (setup, install, dev, test)
- Validação do isolamento do ambiente virtual (.venv)

**Tipos de Teste:**
- Testes unitários para configurações
- Testes de integração para API endpoints

**Dados de Teste:**
- Configurações de ambiente de teste
- Mocks para conexões externas

**Critérios de Teste:**
- 100% de cobertura para health check
- Aplicação inicializa sem erros
- Configurações carregam corretamente

## Riscos e Suposições

**Riscos Identificados:**
- Incompatibilidade entre versões de dependências
- Configuração incorreta do ambiente assíncrono

**Suposições:**
- Python 3.12+ está disponível no ambiente
- UV está instalado e funcionando
- Acesso à internet para instalação de dependências

**Mitigações:**
- Fixar versões específicas das dependências
- Documentar requisitos de sistema claramente
- Criar scripts de setup automatizados

**Planos de Contingência:**
- Usar pip como fallback se UV falhar
- Versões alternativas de dependências documentadas

## Notas de Desenvolvimento

*Seção reservada para anotações durante a implementação*

## Resultados de Testes

*Seção a ser preenchida após execução dos testes*

## Feedback de Revisão

*Seção para feedback de code review e aprovações*

## Log de Mudanças

| Data | Versão | Mudança | Autor |
|------|--------|---------|-------|
| 31/08/2025 | 1.0 | Criação inicial da história | Scrum Master Bob |
| 31/08/2025 | 1.1 | Adicionado Makefile robusto e isolamento completo no .venv | Scrum Master Bob |
